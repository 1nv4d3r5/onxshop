BEFORE EACH RELEASE:
  DELETE FROM common_session;
  DELETE FROM common_session_archive;
  pg_dump --no-owner -U master -h dbserver template_cz-1_4 > database/templates/template_cz-1_4.sql;
  pg_dump --no-owner -U master -h dbserver template_en-1_4 > database/templates/template_en-1_4.sql;
  
  cp -a onxshop-testing onxshop-1.x.x
  rm onxshop-1.x.x/rsync.sh
  update onxshop-1.x.x/ONXSHOP_VERSION
  
  
HIGH PRIORITY

  * TODO: move msg() to a singleton ONXSHOP::MSG class
  * TODO: promote we are using something like http://stacklayout.com/ since 2006
  	remove margins on layout and add margins on each content 
  * TODO: review use of php5-suhosin
  * TODO: fix memory consumption in bo/orders list
  * TODO: rebuild /backoffice landing page
  * TODO: thumbnail.php isn't reading configuration from DB, common_image isn't reading db conf at line 142
  	thumbnail.php isn't reading db conf and should be looking into cache
  * TODO: do crosscheck on payment http://www.worldpay.com/support/kb/bg/paymentresponse/pr5305.html
  	setup Payment Response password (callbackPW)
  * TODO: remove dependancy on bin/ scripts
  * TODO: remove print_article or rename?
  * TODO: use templates/bo/pages/ecommerce/product_detail
  * TODO: merge common_taxonomy_label and common_taxonomy_tree into common_taxonomy, 
  		  rename common_taxonomy_label_image to common_taxonomy_image
  		  1. rename common_taxonomy_tree to common_taxonomy
  		  2. add columns from common_taxonomy_label
  		  3. copy common_taxonomy_label to common_taxonomy
  		  
  		  
INSPIRATION
  http://yuji.wordpress.com/2011/05/25/postgresql-sqlite-django-migrating-postgresql-to-sqlite3-with-pg_dump/
  http://www.root.cz/clanky/zavadime-omezeni-v-openssh/
  Iterator http://zdrojak.root.cz/clanky/lazy-evaluation-v-php/
  Use autoload
  http://www.serversidemagazine.com/community/php-“require”-performance/
  http://uk.php.net/__autoload
  http://www.catswhocode.com/blog/10-useful-htaccess-snippets-to-have-in-your-toolbox
  http://www.openwall.com/phpass/
    
  		  

DATABASE
* consider adding created and modified attrs directly to ecommerce_order
* add suppliers database
* TODO in DB: rename teaser to tagline, rename description to excerpt
* add expires date/time to ecommerce_promotion
* add rating_up and rating_down to comments
* add created field into ecommerce_product (allows sorting by Latest)
* rename client_address.invoices_address_id to invoice_address_id, update ecommerce/checkout_address and component option in the checkout wizard
* TODO: add createTable or createTableSql to all models (and prepare it for an installation script?)
DATABASE Add "available in multiple by" (whole cartoons)
* TODO: DB UPDATE:	rename user_prefs to customer_edit,
					rename ecommerce_product_variety.wholesale to ecommerce_product_variety.trade
					create new ecommerce_price_type and reference to ecommerce_price.type
* TODO: remove ip_address from basket and use session_id?
	ALTER TABLE ecommerce_basket DROP ip_address;
  	ecommerce_basket.session_id integer REFERENCES common_session ON UPDATE CASCADE ON DELETE CASCADE,
  	- problem with moving session to archive, ip_address could be changed to session_id but with no reference
* DB? add new field to model/image: effects, or crop and implement: 
span.image_id_node85 {display: block; width: 300px; height: 200px; overflow: hidden;}
span.image_id_node85 img {margin-top: -20px; margin-left: 0px;}
+ jcrop + http://odyniec.net/projects/imgareaselect/examples.html
+ allow to add margins (change canvas size)
add metatables? http://codex.wordpress.org/images/9/9e/WP3.0-ERD.png
* add subtitle field into product_variety (and move from ean13 on Jingtea)

  * TODO: finish currency update form!!!
  * TODO: check why log level 1 isn't showing
  * TODO: component/feed: Warning: strftime() expects parameter 2 to be long, object given in /opt/onxshop-1.4-dev/lib/xtemplate.class.php on line 886
  	on holicetimes when enabled debuging
  	
* todo: add product list select box to bo/products
* todo: allow download only project files
* TODO: add URL trail to uri_title rename form
* TODO: add subtitle to name_aka
TODO: review valid elements in TinyMCE

TODO: contentSide isn't using publish

* TODO: review image resize WAIT FOR SQUEEZE
  	http://www.imagemagick.org/Usage/thumbnails/#cut
  	http://www.imagemagick.org/Usage/resize/#space_fill
  	
Status Log
Date	Status
2011-03-13 17:06:00	New (unpaid)
2011-03-13 17:08:20	New (paid)

03/13/11 17:05:31 OK: Promotion code 102Uji0211 applied
03/13/11 17:06:00 ERROR: Code 102Uji0211 usage exceed number of allowed applications per one customer (id=18219)


  * TODO: add "403 Forbidden" when page publish = 0 and don't display "node/default: id not numeric" message

67.195.37.157
13:34 http://laposa.co.uk/blog/2011/02/14/continuous-deployment
02/21/11 13:34:30 ERROR: node/default: id not numeric
21/02/2011 13:34
21/02/2011 13:34
Diff: 0 minutes	 n/a	Mozilla/5.0 (compatible; Yahoo! Slurp; http://help.yahoo.com/help/us/ysearch/slurp)

  * TODO: finish bo/component/ecommerce/currency_rate
TODO: configuration local overwrites: add support into node_edit
  	TODO: limit only to pages or improve the way how it's handled?
  * TODO: implement Zend_Auth, Zend_Log and Zend_Db, possibly Zend_Config
  * TODO: create component to see active backend users with option to log them out 
  	SELECT customer_id,	created,	modified,	ip_address,	php_auth_user, http_user_agent FROM common_session WHERE php_auth_user IS NOT NULL
  * TODO: add googlehostedservice.html as conf option?
  * TODO: make packages name internally numerical and assign a title
  * TODO: allow to create blog post layouts like this http://medialoot.com/blog/future-of-design/
  * TODO: review option of using inline {CONTAINERS}, i.e. https://laposa.co.uk/blog/2010/07/21/two-columns-for-everything
  	TODO * disabled {CONTAINERS.x} tags on default node/page/news to allow using them inside the article
  * TODO: split user_prefs into fe/be
  * TODO: split product_edit/other_data https://jing.dev.onxshop.com/backoffice/products/81/edit
  * TODO: Fix pagination on log (remember per page)
  * TODO: check renaming products rename product page
  * TODO: add support for external link to header link (other_data?)
  
	JING
	- TODO: In the SEO manager, is it possible to only show pages which are still active? There are an awful lot of old/disable pages.
	- TODO: Jing: when changing to grid view, display all products
	- TODO: Jing: simplify reset password!important
		http://blog.objectivedigital.com/40384541
  

  
* TODO: fix backup when debugging is enabled or add a warning message
		Warning: pg_escape_string() expects parameter 2 to be string, array given in /opt/onxshop-1.4-dev/lib/adodb/drivers/adodb-postgres64.inc.php on line 241
		Warning: Cannot modify header information - headers already sent by (output started at /opt/onxshop-1.4-dev/lib/adodb/drivers/adodb-postgres64.inc.php:241) in /opt/onxshop-1.4-dev/lib/xsite/Xsite.functions.php on line 125

* not able to login with: wget --save-cookies cookies.txt --keep-session-cookies --user=jing --password=jingtest http://jing.localdev.onxshop.com/request/bo/export/acuity/orders -d

it's not saving session cookies when HTTP redirect?

1.STEP
norbert@carp:~$ wget --save-cookies cookies.txt --keep-session-cookies http://jing.dev.onxshop.com
2.STEP
norbert@carp:~$ wget --save-cookies cookies.txt --load-cookies cookies.txt --keep-session-cookies --user=jing --password=jingtest  http://jing.dev.onxshop.com/request/bo/export/xml_orders
3.STEP
norbert@carp:~$ rm cookies.txt

HIGH PRIORITY
---------
  * add option to AJAX load to enforce uri_mapping (final_output) - all /request/ will use mapping
    related: fix logout
  * make variety_list_ajax general - remove hard links to images and use classes
  * SECURITY: make sure session cookie cannot be stolen, recreate session cookie after login over SSL?
   
JING CHECK
12/05/10 19:39:31 OK: Promotion code 88514697 applied
12/05/10 19:40:45 OK: Registration of customer ID 17458 was successful
12/05/10 19:42:25 OK: New address added to your list.
12/05/10 19:43:20 ERROR: Code 88514697 usage exceed number of allowed applications per one customer (id=17458)
2010-12-05 19:43:20	New (unpaid)
https://jingtea.com/backoffice/orders/32494/detail


	
  	NEW CONFIGURATION OPTIONS:	
  * TODO: create GIFT_WRAP_ID constant, make gift_wrap using new constant GIFT_WRAP_ID
  	in basket detail make sure gift_wrap and gift_packaging have a different picture
  	
--------

	BLOG
  * TODO: create nice URL for news_categories and news_archive
  	TODO: create archive list for URL /2010/06/11
  	TODO: support multiple article containers
  	
  	* TODO: make product detail images square by default?
  	* TODO: list only unique products in best_buys
  	
  		SELECT DISTINCT product_variety.product_id AS product_id, product_variety_id, count(product_variety_id) AS count, product.name AS product_name, product_variety.name AS variety_name 
		FROM ecommerce_basket_content basket_content
		LEFT OUTER JOIN ecommerce_product_variety product_variety ON (product_variety.id = product_variety_id)
		LEFT OUTER JOIN ecommerce_product product ON (product.id = product_variety.product_id)
		LEFT OUTER JOIN ecommerce_basket basket ON (basket.id = basket_content.basket_id)
		WHERE product.publish = 1  AND extract('days' FROM (now() - basket.created) ) < 7
		GROUP BY product_id, product_variety_id, product_name, variety_name 
		ORDER BY count DESC LIMIT 3
		
		panda/_resources/jing-1_4-20101122.sql.gz
		
		  Array
		(
		    [0] => Array
		        (
		            [product_id] => 100
		            [product_variety_id] => 124
		            [count] => 48
		            [product_name] => Jasmine Pearls Green Tea
		            [variety_name] => 50g bag
		        )
		
		    [1] => Array
		        (
		            [product_id] => 111
		            [product_variety_id] => 145
		            [count] => 42
		            [product_name] => Glass Tea Infuser Mug
		            [variety_name] => Mug
		        )
		
		    [2] => Array
		        (
		            [product_id] => 100
		            [product_variety_id] => 597
		            [count] => 38
		            [product_name] => Jasmine Pearls Green Tea
		            [variety_name] => 10g bag
		        )
		
		)
  

  * TODO: product publish and page(node) publish more visible
  	use http://brynmosher.com/jquery.iCheckbox/example.html
  * TODO: update Xsite.model so not-null attributes will be automatically populated
  * TODO: DATABASE add Republic of Serbia to country list
  * TODO: implement http://buildinternet.com/project/supersized/ (downloaded into /opt/)
  * TODO: try new image gallery http://www.slidesjs.com/
  * http://code.google.com/intl/us-EN/web/ajaxcrawling/docs/getting-started.html
  
* debuging, implement magic constants
PHP provides useful magic constants for fetching the current line number (__LINE__), file path (__FILE__), directory path (__DIR__), function name (__FUNCTION__), class name (__CLASS__), method name (__METHOD__) and namespace (__NAMESPACE__).

TODO: start using empty($var) instead of !$var or $var == 0
use abstract class and interfaces http://net.tutsplus.com/tutorials/php/understanding-and-applying-polymorphism-in-php/
(could help to get rid of eval())

  * create composite products
  * included jquery.featureList-1.0.0
    TODO: add features list component ideally as DL
  * included opt/highcharts (non-free)
TODO: everywhere where $this->db->execute($sql), make sure input data for $sql are escaped
*TODO create URL shortcuts like http://bbc.in/cFrTRW
* TODO: make all bo components extending Xsite_Controller_Bo
* change bin/find to glob()
* TODO: optimize for mobile http://dev.opera.com/articles/view/the-mobile-web-optimization-guide/
  * TODO: create simple edit only version for FE
  * TODO: create virtual product browse pages from /categories/ ??
  * TODO: lowercase all requests ie http://jingtea.com/giftS (only for pages, not files, downloads, images)
  * TODO: create news sitemap http://www.google.com/support/news_pub/bin/answer.py?answer=74288
  * TODO: create archive /2010/07/, and articles rename from 2010-07-31 to 2010/07/31
  TODO: add configuration option to disable/enable encryption password in customer db
* implement drag&drop ruler like http://abricocotierfr.appspot.com/ruler
Pure Javascript/HTML/CSS. Made with parts of Kruler, Gnome Screen Ruler, Oli-Web Drag-n-Drop code

FILESYSTEM
implement SSH http://blog.magicaltux.net/2010/06/27/php-can-do-anything-what-about-some-ssh/
http://zdrojak.root.cz/clanky/proste-to-tam-nahrajte-ftpckem-nebo-ne/
  * TODO: implement webdav with Sabredev http://code.google.com/p/sabredav/
	http://www.phpriot.com/articles/web-dav-with-php
	
	
  * TODO: add list of delivery tables
  	SELECT zone.zone_id, country.name FROM ecommerce_delivery_carrier_zone_to_country zone
LEFT OUTER JOIN international_country country ON (country.id = zone.country_id)
ORDER BY zone.zone_id


  * http://thinkvitamin.com/dev/oop-with-php-finishing-touches/
  * TODO: create placeholder content component like http://placehold.it/
  * http://www.sotechnology.co.uk/
  * http://tweet.seaofclouds.com/
  * create debian package with Debreate http://debreate.sourceforge.net/
    http://www.webupd8.org/2010/01/how-to-create-deb-package-ubuntu-debian.html
  * http://www.serie3.info/s3slider/
  * http://cssglobe.com/post/5780/easy-slider-17-numeric-navigation-jquery-slider
  * http://www.marcofolio.net/webdesign/the_polaroid_photo_viewer_non-full_screen.html
  * http://tutorialzine.com/2009/11/beautiful-apple-gallery-slideshow/
  * http://www.uploadify.com/
  * TODO: implement flat CSV list for promotion code (one code per one line) (see email from David 12 July 2010)
  * TODO: implement Media Queries http://www.smashingmagazine.com/2010/07/19/how-to-use-css3-media-queries-to-create-a-mobile-version-of-your-website/
  * TODO: add somewhere a notice, that wrappers should always have even values for padding in order to keep 50/50
  * TODO: improve address_edit component don't display remove button on active address, allow to change
  * TODO: implement http://www.wbotelhos.com/raty/
  * TODO: use textile for quotes component
  * TODO: check image resize option from RTE add image
  
  * TODO: sort images interface in picture gallery
  * TODO: file upload with drag&drop, easy CSS/images management (theme?)
  		http://robertnyman.com/2010/12/16/utilizing-the-html5-file-api-to-choose-upload-preview-and-see-progress-for-multiple-files/
  * TODO: display "contact us for more detail" when price 0.00
  * TODO: check image thumbnails delete when overwrite image or image delete, upload the same again
  * TODO: write URL management tool (redirects)
  * TODO: regenerate NICE URI table in template
  * TODO: add privacy policy page into the template
  * TODO: make Google Sitemap more efficient and store HTTP headers (content-type)
  * TODO: update search index in Xsite.bootstrap:cache
  
https://developer.mozilla.org/en/Using_files_from_web_applications
http://openlike.org/
  * TODO: implement node table as key:value tables?
  * TODO: add "useful up" and "useful down" attributes to comments and reviews
  * TODO: fix database listing error messages and pagination
  * TODO: include Laposa procedures for installation into Onxshop dir (move to /opt, add /opt into backup directory)		
  * TODO: implement dont_scale_up option to thumbnail generator
  * TODO: bo/configuration
  	- fix menu for listing ecommerce pages?
  	- move tfoot after thead in all templates
	TODO add javascript posthook to page update?
	
  * TODO: fix display permission on menu (use it for login/logout)
  * TODO: check display permission in menu - don't display in menu if user have no permission to view page
* rewrite csv_from_fs to use glob() function  
* TODO: simplify product variety interface (fix forward after adding new variety - price)
* improve CSS and frontend edit (maybe Bespin editor or SHJS)
http://cssdesk.com/
http://www.concrete5.org/
* TODO: REDO: CSS 50/50, 20/80 with odd width value (will work in IE)
* implement? http://www.modernizr.com/
* TODO: make product edit page full width
* TODO: add highlight option to product?
* TODO: add teaser and description type attribute to product? RTE|textile
* TODO: fix node/content/shared
* TODO: fix page_builder or remove it completely
	./bo/component/node_add.php
	./bo/component/news_add.php
* TODO: fix filter
	./component/filter.php
	./node/content/filter.php
	./bo/node/content/filter.html
	finish filter in bo/node/content/news_list
* TODO: join common_taxonomy_label and common_taxonomy_tree into common_taxonomy
* TODO: /product/code/{CODE} or /product/{A-Za-z0-9}, /product/variety/{variety_id}
* TODO: clean htaccess
  
  
	JING TASKS
	TODO: add county list and carrier list to backoffice free delivery product code edit
	Add tickbox to product variety edit - "available for wholesale only"
  * TODO: tasks from 2010/02/19
  		2. SORTING BY New Product, Review Rating, Name, Price, Popularity
		- add available for wholesale only to variety table
  * TODO: sales report as requested by David in December
  * TODO: repeat order facility
  * TODO: export meta data for pages
  * TODO: add a way export product list with associated categories and other data attributes
  
  
    	FRONTEND EDIT
  * TODO: make sure footerNavigation/contact-us symbolic link cannot be in conflict with global/contact-us
  * TODO reload primaryNavigation and footerNavigation and globalNavigation after adding a page
  * TODO: fix conflict between jquery tools and UI for tabs in fe_edit (currently tab removed from jquery-ui-1.7.2.custom.min.js)
  * TODO: it's not refreshing content on save when duplicate content and edit this content
  * TODO: clean default CSS to be less specific - not to use to much inheritance
  * TODO: add new colour schemes http://www.colorhunter.com/tag/F0F0F0/1
  * put headings into basic, separate better minor tweaks and under the hood
  * add link to node heading
  
  
* split server_browser_file_list into upload and list
* why whole page reloads when picture content updated? because there is a posthook
* add twoColumns property to contact form edit
* make sure after changing order status, the whole page reloads with newly created invoice
* make add_to_basket_ajax/variety list as form with buttons
* fix ./bo/node/content/news_list.php (add category filter)
* add customer support email and telephone to global configuration and use it in default email templates
* fix menu list, when filename same as folder name (ie payment.php in component list)
  

  * TODO implement Google XML RPC ping
TODO: implement interface to allow lock some users (temporarily disable), client_customer.status = 0
  

  
  * TODO: make possible to run different installation on different root ie "/europe/" or "/asia/"
      - get rid of all "/" referencies
	      - create a new constant WEBAPP_ROOT or BASE_URL or $conf['base_uri']

TODO create a dev status variable to deployment, DEPLOYMENT_STATUS = stage, testing, live (default)
	/**
	 * deployment status
	 * (development, test, production)
	 */
	
	define('DEPLOYMENT_STATUS', 'development');

  	<meta name="robots" content="noindex, nofollow" />
	Header set X-Robots-Tag "noindex, nofollow, noarchive, nosnippet"
	
TRANSITION TO Zend_Db  
2009-12-08 03:23:35 GMT WARNING:  nonstandard use of \' in a string literal at character 71
2009-12-08 03:23:35 GMT HINT:  Use '' to write quotes in strings, or use the escape string syntax (E'...').
2009-12-08 03:23:35 GMT ERROR:  unterminated quoted string at or near "'/edit\'  ORDER BY id ASC " at character 71
2009-12-08 03:23:35 GMT STATEMENT:  SELECT * FROM common_uri_mapping  WHERE type = '301' AND public_uri = '/edit\'  ORDER BY id ASC 
TODO: fix memory leak at  /usr/local/lib/xsite-1.3.2/models/ecommerce/ecommerce_order.php on line 302
		(display all orders on jingtea.com)
		possibly will improve with using Zend_Db (rewrite Xsite.model to not use eval())
		- get rid of eval() etc to allow http://www.sitepoint.com/blogs/2010/02/04/boost-php-performance-with-hiphop/
		- all NOT NULL db attributes with required=true?
		- prepare for writing to master and read from slave (multiple slaves)
		
TODO: integrate SlickmapCSS for component/sitemap
* TODO: Amazon S3 for backups

INDEXED SEARCH
   - TODO: allow white space in URL in fulltext index initialisation
   - TODO: pagination
   - TODO: split bo/advanced/search_indexed component in two parts:1.review, 2. reindex
   - TODO: index pages and content during nodeUpdate
   - TODO: update in project_skeleton
   		- TODO add <p>{I18N_PLEASE_ENTER_YOUR_EMAIL_ETC}</p> into project_skeleton
   
SSL FORWARD
  * TODO: remember HTTP headers for cached objects
  * TODO: start using require_ssl to solve problem with login form HTTP -> HTTPS forward and loosing POST data
   - and make sure other pages are forwarded to HTTP
  - fix SSL forcing to work in a way, that hack in component/password_reset is not need 
  (probably check all nodes before processing if they have force_ssl attribute)
  same is needed for cache
  
  * TODO: fix jQuery validation conflict on the address edit page
* TODO: implement http://www.echosign.com  
* redesign backoffice with ideas from http://checkoutapp.com/
* add list of customers who bought product in product detail
  (facility to find all customers who bought certain product)
* allow to delete unpaid orders or new status "deleted"?

* make SSL on content with require_ssl

* allow to delete a variety which no one has bought  
* TODO share _initTemplateVariables function from Xsite.controller in common_email_form._format
  - process mail templates with nSite
* TODO: add website tagline?
  * Add customer service email and telephone number to the configuration, add all contact detail,
    probably as a freetext
* TODO: mandatory registration email check configuration option
* get rid of all insert() in models and controllers and make mandatory $data array in models->insert($data)
TODO make global.locale constant to keep it consistent
TODO: make locale controller configureable and move GLOBAL_DEFAULT_CURRENCY into configuration
* TODO: configuration interface for international_currency
 - allow to add a new currency value into international_currency (similar to add a new price)
* TODO: possible option: product_list added to node/page/default (no need to choose product_browse type)
  {XSITE_REQUEST_product_list #component/ecommerce/product_list_in_node_optimized~id=GET.id:template_block=product_more~}
  - or consider to remember last selected node type when adding page
TODO: move backoffice/client components from ecommerce bo/component	(finish split CMS/ecommerce)
TODO: create setup wizard like summercart.com
TODO: research other solutions: HSBC Merchant Services – Online debit and credit card processing shopping carts
	Actinic (www.actinic.co.uk)
	Adelante (www.adelante.co.uk)
	BazaarBuilder (www.bazaarbuilder.com)
	BT eShop (http://business.bt.com/domains-and-web-hosting/web-hosting/eshop)
	BT Openworld Internet Trader (www.btindirectchannels.com)
	ClickcartPro UK (www.clickcartpro.co.uk)
	EKM Powershop ( www.ekmpowershop.co.uk)
	e-Pages (www.epages.co.uk)
	EROL (www.erolonline.co.uk)
	E-Volve or lynx (www.lynxinternet.com)
	Intershop (www.intershop.co.uk)
	Oscommerce (www.oscommerceuk.com)
	RomanCart (www.romancart.com)
	Shopcreator (www.shopcreator.com)
	Tolranet (www.tolranet.co.uk)
	X cart (www.x-cart-plus.com)
	http://www.oxid-esales.com


implement jcrop and other plugins http://www.sitepoint.com/blogs/2009/09/14/seven-jquery-plugins-images/
  http://www.newfangled.com/content_management_system_website_applications
  * Calendar of Events (based on ics, Google Calendar, iCal)
  * Online Surveys
  * Online Polls

  * Send an email after order has been dispatched with this detail:
    Customer service email sales@postmetoday.com
    Customer service phone numbers 0870 850 7698 or 01293 613777
    and postage detail, check mail from Amazon 13th August 2009 for inspiration
  * TODO: check discount calculation for items with quantity > 0 (more info in ecommerce_order->getBreakdown discount price reduce)
  * add worldpay logos: <script language="JavaScript" src="https://secure.wp3.rbsworldpay.com/wcc/logo?instId=141623"></script>
  * fix initialization of jquery.cycle after AJAX refresh in bo/node/content/picture (uses refresh of whole page in hookNodeEditPostUpdate)
  * TODO: fix SSL on add to basket, //BUG FIX in node/page/commerce: don't exit in this case, it cause problems when adding to basket
    - fix forward to non-SSL ie https://www.onxshop.com/about-us
    - add exception for basket page id?
    - https://jingtea.com/contact-jing not forwarding to non-ssl
    - need to finish "require ssl" node option and use it before getting content from cache


* add |htmlspecialchars into every possible place in backoffice in order to make demo.onxshop.com bulletproof
* improve Model->delete, to show error when deleting non existing item
* refresh children list after deleting item in node edit
  * TODO: in BO: add option to remove unused promotion, refresh list after insert/update,
    add link on usage to order list with promotion filter
    TESTING:
    BUG fix double message "Discount cannot be bigger than order value" when changing 10items for 1item in basket edit
    BUG fix promotion code after basket update (item removed)
  * TODO: make sure customers outside EU are not charged with VAT
  * TODO: implement uses_per_customer in commerce_basket->applyPromotionCode
  * think about allowing delivery address change when order is submitted (maybe in backoffice only, can ask for paying difference in postage)
  * TODO: implement option for inline renaming of filename in server_browser when file usage = 0
  * TODO: fix "canvas" in HTML in HTML validator
  * TODO: add timezone configuration option, default by locales
 
  * TODO: allow to add fixed discount when doing order from backoffice
  * TODO: implement phpweather
  * TODO: move ULFromArray to a controller
  * TODO: sell onxshop like a prototyping/wireframing tool as www.axure.com or http://www.jumpchart.com/?
  * TODO: don't display not public pages in site search result
  * TODO: implement > selector (Selects an element that is a child of another element)
  * TODO: implement &#9650; &#9654; &#9660; &#9664 etc icons http://www1.tip.nl/~t876506/UnicodeDisplay.html
  * TODO: change Tidy into htmlpurifier? use it instead of class html2text?
  * TODO: fix xsite-dev/controllers$ grep nSite `find ./`|grep @
	check syntax controller~param:value~@view~param:value~

  * TODO: improve discount codes management:
    - {code***} where "code" is compaign identifer and *** is any number. when provided {code***} give {percentage|fix} discount on any order but maximum xxx usages
    - implement {percentage|value} discount where {amount>xxx}
    - implement {free delivery} discount where {delivery address}
    
HIGH PRIORITY TASKS:

  TODO: fix content/menu select interface
  * TODO: delete basket if order was not finished when session expire
  * TODO: add option to assign an image or content for shipping documents for each delivery carrier
  * TODO: delivery rates management, 
  	TODO: find default carrier from ecommerce_delivery_carrier table in component/ecommerce/delivery_option
  	TODO: add option "if (order_value > 50) use carrier_id 3"
  * TODO: make depricated update() without any input array ($Customer->update() to $Customer->update($data))
  
TASKS REQUIRED FOR ACCESSING A WIDER MARKET:
  TODO: reload tree on left content is updated in /backoffice/cms
  TODO: add a new content as a quick wizard
  TODO: max sure layout in backoffice doesn't break with a bigger font size
  TODO: create a good looking template, simple design idea for universal logotype: http://www.sebrov.cz/ostatni
  TODO: link to change address from customer detail page leads to change address in backoffice instead of frontend
  		- show list of all customer addresses directly in backoffice
  

TASKS REQUIRED BEFORE GOING OPEN-SOURCE:
  * TODO: implement Zend_Auth, Zend_Acl (allow to use net.ll without hack in Xsite.bootstrap, authentication.php and backoffice.php)
  * TODO: implement ZendDB, Zend_Config
          
TECHNICAL NICE:
  TODO: make all "add relation" components (tree + list) working in the same way
  TODO: check secondary navigation style
  TODO: add limit to node_layout to display only certain folders ($this->GET['node_type'] changed to a list)
  TODO: fix sorting orders

  TODO: don't store cached pages when debug level > 0
  TODO: disable direct request (or combined) for anybody but backoffice
  TODO: hide robots in log or don't log session for Pindom.com_bot
  TODO: add all node.relations and check "referencies"
  
ADVANCED FUNCTIONALITY:
  TODO: add header link to node
  TODO: Add link option to node/content/picture
  TODO: add facility to create TOC in content/menu
  TODO: finish crawl
  TODO: write an interface for static 301 redirect rules management
  
USABILITY:
  TODO: /backoffice/cms will be similar to frontend edit, but with no pop-up windows
  TODO: allow a clever direct image add with looking what's parent layout size
  TODO: limit title size to 64chars (add a warning)
  TODO: implement auto-suggest for search: http://woork.blogspot.com/2009/02/useful-ajax-auto-suggest-scripts.html
  TODO: implement cropping of uploaded images http://www.webmotionuk.co.uk/php-jquery-image-upload-and-crop/
  TODO: add trim option for certain height for images
 

FRONTEND
  * TODO: (problem with "-" character in variable name) Xtemplate updated from subversion 2008-09-17
  * TODO: add option for expanding news and products in component/sitemap
  * TODO: remove news from menu
  
BACKOFFICE
cms
  * TODO: use fortunes as an option in node/content/quote
  * TODO: reload file_list when adding a new one
  * TODO: when update a page, reload whole page, not just content
  * TODO: make validation for URI title - not allow absolute URL
  * TODO: hide teaser image role or find a use for it
  * TODO: improve error message on HP adding subpage, fix detail() error
  * TODO: add limit for very tall images in media library, fix link to root (doesn't work from CSS)
  * TODO: add option to open image in full to image gallery
ecommerce
  
  * TODO: add a warning if product has no related page, or update highlight of product to do that check
  * TODO: display products details if not published and admin
  * TODO: !!! find a way how to manage product type and VAT rate - keep old records, hide old record
  * TODO: interface for changing shipping rates
  
  
  * TODO: add an option to registration controller to check Agree with T&C 
  * TODO: show company details in user detail and create a companies list
  * TODO: fix redirect after delete folder in media library
  * TODO: Paypal, Google Checkout integration (Requires valid SSL cert for callback with XML API or having only one tax for HTML API use)
  * TODO: fix content/file, content/teaser, content/filter, disable temporarily
  * reflects order of items in array from node_layout

- stock level should be always up-to-date on the frontend
- fix pagination after when page filter is used in product list
- fix tree in shared content


GLOBAL:
- check all indexes and references
- change of namespace from "xhtml.admin.bo/pages.bo/page_edit" to "xhtml/admin/bo.pages/bo.page_edit" (?)
	xhtml/admin/bo.pages@bo.pagesspecial/bo.page_edit
- use XML_SYNTAX of templates (templates/html/XML_SYNTAX.html)
	allow using id params in request: ID and NAME tokens must begin with a letter ([A-Za-z]) and may be followed by any number of letters, digits ([0-9]), hyphens (”-”), underscores (”_”), colons (”:”), and periods (”.”).
- to, from: urlencode
- fix problem with XSITE_REQUEST and other {} on one line
- regexpres in parseLI($item) in ULFromArray.class
- BASE_URI with slash?
- don't use goTo after some upgrade - better for integration - set a redirece in the http request and don't exit
- image - check if is not there with same name, check allowed characters..., deleting of thumbnails, editing of images
	- rename image to image alt 
	- import whole directory
	- check filename - rename as in mapping
	- remove prefix "/var/images/" and use /cms/images/ for rewrite engine
	- image/get.php, implement with nSite?
	- thumb manage with get.php?image=/var/wwa&thumb=100
		- cache it

- update URI MAP
	- do checking of duplicates

- template edit in BO
- in email do rel2abs()
- in the bin/ directory, add to all commands parameters double quotes? only for filenames?
- user registration: allow groups (ie retail, wholesale), allow image upload, optional use username or email address, allow admin approval
- allow required attribute to be set in configuration (not direct in model), perhaps add "config" instead of required=true|false
- implement Debian menu system?

- passing parameter with bo/edit.backoffice.bo/ecommerce/customer_list&status=2 not working, only if bo/edit.backoffice.bo/ecommerce/customer_list~status=2~
- find why it's not showing error messages from controllers/bo/ecommerce/relation_product_in_nodes.php
- make all generic.update,detail,insert as private and from controllers use wrapper, ie orderInsert(), nodeInsert, ...
- implement some general  notification system between controllers, something like now now is in image.php:image_gallery.php and node/content/contact_form.php:component/contact_form.php
	- or $GLOBALS['notify']['registration']
- use Generic->count method on all paginations
- add new attribute type "serialized" with a validation
- switch country to typo3/static
	- implement all info_static tables
- Add limit to recursive function, like CVE-2007-1325
-----------------------------------------------------------------------------------------

CMS:
- function validateParent($value) is not necessarly to call every time - only on update
- display only the public pages in pages browser invoked from the RTE
- use teaser of page as description (good for Google results)
	- now it uses only advance/description
- allow set some template for page and different one as default template for all subpages (as typo3)
- FIX problem with missing relation to page in shared content/layout
-----------------------------------------------------------------------------------------

SHOP:
- Stock Management - Import/export stock values, HTTP interface for stock management.
- allocate product when added to basket, remove from stock when shipped, Allocate product when added to the basket, reduce stock value after payed. If customer don't finish order, remove product allocation after session expire.
	- this can be done with deleting basket with not finished order when session expire
* TODO: fix "activity between" in bo/orders
- implement availibility option to each product (on stock, 1week, 2weeks, 3weeks, 1 month)
	(is already in database)
- allow doing backoffice orders on behalf of customer
- add discount option in backoffice shopping - only for whole order (total - discount)
- get all prices in ecommerce_product_variety
	mixing of international_currency and ecommerce_price
	ECOMMERCE_PRICE_CURRENCY_DEFAULT
	INTERNATIONAL_CURRENCY_DEFAULT
	toCurrency rewrite to processing single convert - using international_currency
- BUG: cant add company after registration without company (do better company management)
- do we need basket data in getOrder($id) (ecommerce_order.php)
- price history, is right price_id in basket_content? isnt better store ie serialized basket (like for protX) content with prices in order or transaction?
- dont delete related pages after update of product, because it's deleting ordering of page/product as well (controllers/bo/ecommerce/relation_product_in_nodes.php)
- add checkStock into basket_update (now its only on checkout)
- store order data in common_email? saving of whole email text
* TODO: delete basket if order was not finished when session expire
  	add database reference from basket to session
    - add allocated attribute to variety?

-----------------------------------------------------------------------------------------

        loglevel=       All Kernel Messages with a loglevel smaller than the
                        console loglevel will be printed to the console. It can
                        also be changed with klogd or other programs. The
                        loglevels are defined as follows:

                        0 (KERN_EMERG)          system is unusable
                        1 (KERN_ALERT)          action must be taken immediately
                        2 (KERN_CRIT)           critical conditions
                        3 (KERN_ERR)            error conditions
                        4 (KERN_WARNING)        warning conditions
                        5 (KERN_NOTICE)         normal but significant condition
                        6 (KERN_INFO)           informational
                        7 (KERN_DEBUG)          debug-level messages

  * TODO: Keep old priority in bo/ecommerce/relation_product_in_nodes
  ($Node->update($product_node))
  * TODO: add archive option new_list or create a new component, or extend
  filter?
  * TODO: Add "optgroup" option to content/menu, copy options from typo3
  * TODO: Remove HTML tags on CSS save

  * TODO: Check node name on insert,update,move
  * TODO: Improve pagination, to be like Google's (Zend_Pagination?)
  * TODO: Fix Shared Layout, Layout icon
  * TODO: option for interpreting pure HTML content el as Xsite
  * TODO: improve stats - visitors, customers, orders values

  * TODO: Change logout button functionality
  * TODO: RSS for new orders
  * TODO: Link for print invoice from email (with login)
  * TODO: move msg function to Xsite class or have only one messages
    container or don't slide messages to parent?
  
  * TODO: implement email protection with http://uk2.php.net/htmlentities
  * TODO: add link option to content/picture (not sure if needed, RTE can be used)
  * TODO: on add new content, open edit window automaticly
  * add banner content element
  * add relation to page to news items
  * fix order detail in client area for customer who has no orders

  DATABASE CHANGES:
  * TODO: limit meta tag description to 160chars
  * TODO: change description and keywords to varchar(255)
 
  * TODO: alter ecommerce_order, referrer -> referer
  * TODO: move ONXSHOP_MAIN_DOMAIN into the database
  * TODO: add force SSL as node option
  * TODO: Add globalNavigation to project_skeleton

--------------
- implement http://uk2.php.net/manual/en/function.syslog.php
- allow digital product, VAT change to NOVAT,SR_VAT,RR_VAT
- allow periodical payment
- add NO VAT option to company property
- !!! add checking of title and URI title (if exists the same on same level) on page add/update !!!
- update pubDate in rss export
- DONE with BO advanced/tools: update common_uri_mapping on any changes: FIXED with BO advanced/tools
	- NOTIFY IN RELEASE NOTES don't allow duplicates (on generate)
	- NOTIFY IN RELEASE NOTES force to have for product at last one home page and that ID allways keep, only move
	- BUG: seems to be called twice (try remove deleting before insert...)
- DONE with BO advanced/tools: allow flush of the cache on BO user request
- LN5 admin user backup, download of whole site
	- without cache (split var/cache to separate folder?)
	- should be only files folder and database
	- ftp access only to files folder, store there backup as well
	- backup will be a ftp link
- NEXT VERSION admin user configuration of language file and basic from global.conf (move to the database)
	- configuration of all conf/
	- use generic.validation() during population
	- from database create _GLOBAL['conf'] 
	- from GLOBAL[conf] create constants
- DONE with ECOMMERCE_TRANSACTION_TYPE: admin user choose of payment type 
	- allowed payment types on installation and display them on checkout
- LN5 INSTALLATION: admin user choose of allowed delivery type (only one for the site?)
- allow change of design in BO
	- editable main template? + EXTRA_BODY_TOP, EXTRA_BODY_BOTTOM, EXTRA_HEAD
		- allow add XSITE_REQUEST to the template like a component
	- NO configureable CSS file linked to the fileadmin
	- NO public_html/css/, images/js/, swf/ linked to the fileadmin 
- NEXT VERSION BO users (role): 
	admin
		- not limited
		
	editor
		- page management
		- logs
	products
		- product management
	warehouse
		- orders and stock management
- NEXT VERSION: create common_messages and use it in msg()
- INSTALLATION: during installation get info for INVOICES, get logo image, allowed currencies, admin email
- NEXT VERSION allow add files like PDF to the product, allow to download them after ordering


